# 基于Alpine的超简化版本 - 参考成功的ffmpeg-worker
FROM alpine:latest

# 安装Python3
RUN apk add --no-cache python3 py3-pip

WORKDIR /app

# 复制最简单的服务器
COPY minimal_server.py .

# 设置环境变量
ENV PYTHONUNBUFFERED=1

# 暴露端口
EXPOSE 8080

# 健康检查
HEALTHCHECK --interval=30s --timeout=10s --start-period=60s --retries=3 \
    CMD python3 -c "import urllib.request; urllib.request.urlopen('http://localhost:8080/')" || exit 1

# 运行命令
CMD ["python3", "minimal_server.py"]