# 超级简化Dockerfile - 用于调试容器启动问题
FROM python:3.11-slim

WORKDIR /app

# 只复制最简单的服务器
COPY minimal_server.py .

# 设置环境变量
ENV PYTHONUNBUFFERED=1

# 暴露端口
EXPOSE 8080

# 健康检查 - 使用Python内置urllib
HEALTHCHECK --interval=30s --timeout=10s --start-period=60s --retries=3 \
    CMD python -c "import urllib.request; print(urllib.request.urlopen('http://localhost:8080/').read())" || exit 1

# 直接运行Python脚本
CMD ["python", "minimal_server.py"]