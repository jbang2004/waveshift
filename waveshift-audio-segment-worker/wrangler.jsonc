{
  "name": "waveshift-audio-segment-worker",
  "main": "src/index.ts",
  "compatibility_date": "2024-12-01",
  "compatibility_flags": ["nodejs_compat"],
  
  // Container é…ç½® (æ–°ç‰ˆWrangleræ ¼å¼)
  "containers": {
    "AudioSegmentContainer": {
      "image": "./Dockerfile",
      "instance_type": "standard",
      "max_instances": 3
    },
    "DenoiseContainer": {
      "image": "./denoise-container/Dockerfile", 
      "instance_type": "standard",
      "max_instances": 3
    }
  },
  
  // Durable Object ç»‘å®š - Container éœ€è¦å¯¹åº”çš„ DO ç»‘å®š
  "durable_objects": {
    "bindings": [
      {
        "name": "AUDIO_SEGMENT_CONTAINER",
        "class_name": "AudioSegmentContainer"
      },
      {
        "name": "DENOISE_CONTAINER",
        "class_name": "DenoiseContainer"
      }
    ]
  },
  
  // å®¹å™¨è¿ç§»é…ç½® - åˆ é™¤å¹¶é‡æ–°åˆ›å»ºAudioSegmentContainerä»¥ä¿®å¤Containeré…ç½®
  "migrations": [{
    "tag": "v15", 
    "delete_classes": ["AudioSegmentContainer"],
    "new_sqlite_classes": ["AudioSegmentContainer", "DenoiseContainer"]
    // å…ˆåˆ é™¤æœ‰é—®é¢˜çš„AudioSegmentContainerï¼Œç„¶åé‡æ–°åˆ›å»ºæ‰€æœ‰Containerç±»
  }],
  
  // ç¯å¢ƒå˜é‡
  "vars": {
    "ENVIRONMENT": "production",
    "CLOUDFLARE_ACCOUNT_ID": "1298fa35ac940c688dc1b6d8f5eead72",
    "R2_BUCKET_NAME": "waveshift-media",
    "R2_PUBLIC_DOMAIN": "media.waveshift.net",
    // ğŸµ éŸ³é¢‘åˆ‡ç‰‡æµå¼å¤„ç†é…ç½®
    "GAP_DURATION_MS": "500",            // å¥å­é—´gapé™éŸ³æ—¶é•¿
    "MAX_DURATION_MS": "12000",          // æœ€å¤§ç‰‡æ®µæ—¶é•¿ï¼ˆåŒ…å«gapï¼‰
    "MIN_DURATION_MS": "1000",           // æœ€å°ä¿ç•™æ—¶é•¿ï¼ˆä»…è¿‡æ»¤å­¤ç«‹å•å¥ç‰‡æ®µï¼Œè¿ç»­å¯¹è¯ä¸å—å½±å“ï¼‰
    "GAP_THRESHOLD_MULTIPLIER": "3"      // é—´éš”æ£€æµ‹å€æ•°ï¼ˆå°äº3å€gapæ—¶ç›´æ¥åˆå¹¶ï¼‰
  },
  
  // D1 æ•°æ®åº“ç»‘å®š
  "d1_databases": [{
    "binding": "DB",
    "database_name": "waveshift-database",
    "database_id": "005024c1-ef6e-4f7d-8b86-07995a53dc49"
  }],
  
  // R2 å­˜å‚¨ç»‘å®š
  "r2_buckets": [{
    "binding": "R2_BUCKET",
    "bucket_name": "waveshift-media"
  }],
  
  // æ—¥å¿—è§‚æµ‹é…ç½®
  "observability": {
    "enabled": true
  }
  
  // æ„å»ºé…ç½® - ç§»é™¤ TypeScript æ„å»º
  // "build": {
  //   "command": "npm run build"
  // }
}